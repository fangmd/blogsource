---
title: 高斯模糊
date: 2016-04-13 14:38:14
tags: 高斯模糊
categories: android

---

# 高斯模糊

<!--more-->

## 导入

app\build.gradle

	defaultConfig {
        applicationId "com.doublefang.designappbardemo"
        minSdkVersion 14
        targetSdkVersion 23
        versionCode 1
        versionName "1.0"
        renderscriptNdkModeEnabled true
        renderscriptTargetApi 19
    }

## 使用
导入v8包可支持低版本

    Bitmap bitmap = BitmapFactory.decodeResource(getResources(), R.mipmap.ic_launcher);
    RenderScript rs = RenderScript.create(getApplication());
    ScriptIntrinsicBlur blur = null; // 获得高斯模糊脚本对象
    if (android.os.Build.VERSION.SDK_INT >= android.os.Build.VERSION_CODES.JELLY_BEAN_MR1) {
        blur = ScriptIntrinsicBlur.create(rs, Element.U8_4(rs));
        blur.setRadius(20); // 设置模糊半径
        Allocation in = Allocation.createFromBitmap(rs, bitmap); // 输入
        Bitmap outBitmap = Bitmap.createBitmap(bitmap.getWidth(), bitmap.getHeight(), Bitmap.Config.ARGB_8888);
        Allocation out = Allocation.createFromBitmap(rs, outBitmap);
        blur.setInput(in);
        blur.forEach(out);
        out.copyTo(outBitmap);
        mAppBar.setBackgroundDrawable(new BitmapDrawable(getResources(), outBitmap));
    }

picasso高斯模糊：

    Picasso.with(AlbumDetailActivity.this).load(albumInfo.getCoverLarge()).into(new Target() {
        @Override
        public void onBitmapLoaded(Bitmap bitmap, Picasso.LoadedFrom from) {
            RenderScript rs = RenderScript.create(getApplication());
            android.support.v8.renderscript.ScriptIntrinsicBlur blur = android.support.v8.renderscript.ScriptIntrinsicBlur.create(rs, android.support.v8.renderscript.Element.U8_4(rs));
            blur.setRadius(20);
            Allocation in = Allocation.createFromBitmap(rs, bitmap);
            Bitmap outBitmap = Bitmap.createBitmap(bitmap.getWidth(), bitmap.getHeight(), Bitmap.Config.ARGB_8888);
            Allocation out = Allocation.createFromBitmap(rs, outBitmap);
            blur.setInput(in);
            blur.forEach(out);
            out.copyTo(outBitmap);
            mAppBarLayout.setBackgroundDrawable(new BitmapDrawable(getResources(), outBitmap));
            mAlbumImg.setImageBitmap(bitmap);
        }

        @Override
        public void onBitmapFailed(Drawable errorDrawable) {

        }

        @Override
        public void onPrepareLoad(Drawable placeHolderDrawable) {

        }
    });