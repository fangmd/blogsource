---
title: android 5.0 共享元素
date: 2016-04-03 13:18:12
tags: [android 5.0, 共享元素]
category: android

---

# 步骤
1. 源布局中的一个控件设置属性:` android:transitionName="transitionName"`
2. 目标布局中的一个控件设置属性:` android:transitionName="transitionName"`

跳转方法:

```java
    public static void actionStart(Activity context){
        Intent intent = new Intent(context, LearnNewsActivity.class);
        if (android.os.Build.VERSION.SDK_INT >= android.os.Build.VERSION_CODES.LOLLIPOP) {
            Pair<View, String>[] pairs = TransitionHelper.createSafeTransitionParticipants(context, true);
            ActivityOptionsCompat optionsCompat = ActivityOptionsCompat.makeSceneTransitionAnimation(context, pairs);
            ActivityCompat.startActivity(context, intent, optionsCompat.toBundle());
        }else {
            context.startActivity(intent);
        }
    }
```

style 21 主题中增加:

```java
<item name="android:windowContentTransitions">true</item>
```

# 导航栏闪白处理

[https://stackoverflow.com/questions/26600263/how-do-i-prevent-the-status-bar-and-navigation-bar-from-animating-during-an-acti](https://stackoverflow.com/questions/26600263/how-do-i-prevent-the-status-bar-and-navigation-bar-from-animating-during-an-acti)
[https://codeday.me/bug/20170630/29499.html](https://codeday.me/bug/20170630/29499.html)

在目标 Activity 中调用下面的代码。

```java
    protected void setupWindowAnimations() {
        super.setupWindowAnimations();
        

        Fade fade = new Fade();
        fade.setDuration(500);
        fade.excludeTarget(android.R.id.statusBarBackground, true);
        fade.excludeTarget(android.R.id.navigationBarBackground, true);
        getWindow().setReturnTransition(fade);
        getWindow().setEnterTransition(fade);

        // or
        //getWindow().setEnterTransition(null);
        //getWindow().setReturnTransition(null);
    }
```