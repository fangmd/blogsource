---
title: 深入理解计算机系统
date: 2017-11-04 21:18:12
tags: [ReadNote]
category: 读书笔记

---

# 第一章 计算机系统漫游

系统在执行下面 代码 的时候发生了什么

hello.cpp

```c++
#include <iostream>
using namespace std;
 
// main() 是程序开始执行的地方
 
int main()
{
   cout << "Hello World"; // 输出 Hello World
   return 0;
}
```

## 信息就是 位 + 上下文

hello 程序生命周期从其 源文件 开始。源文件实际就是由值1/0组成的 bit 序列。8 bit 为一个字节，一个字节表示一个文本字符。

大部分现代系统都是用 ASCII 标准表示文本字符。（用一个唯一的单子节大小的整数表示每个字符）

比如: # 字符对应 35

```
#->35
i->105
...

```

hello.cpp 这样只由 ASCII 字符构成的文件称为 **文本文件**，其他文件称为 二进制文件。

## 程序被其他程序翻译成不同的格式

hello.cpp 是可以被人类读懂的文件，但是要让它在电脑中运行还需要将其转化成 机器语言指令，将这些 指令 按照 可执行目标程序 的格式打包好，以二进制磁盘文件形式存放起来。

源文件到可执行文件： 

```
g++ hello.cpp -o hello
```

## 了解编译系统如何工作是大有益处的

## 处理器读并解释存储在存储器中的指令

上面的步骤把： hello.cpp 编译成了 hello 可执行文件。

运行这个文件：在 shell 中运行这个执行文件

```
./hello
```

### 系统的硬件组成


![系统硬件组成](https://raw.githubusercontent.com/fangmd/markdownphoto/master/src/%E7%B3%BB%E7%BB%9F%E7%A1%AC%E4%BB%B6%E7%BB%84%E6%88%90.png)

1. 总线：贯穿整个系统的电子管道
2. I/O 设备：每个 I/O设备 都通过 控制器或适配器 与 I/O总线 相连接.(控制器是主版上的芯片组，适配器则是主版插槽上的卡)
3. 主存：临时存储设备，由 一组动态随机存取存储器（DRAM）芯片组成的。
4. 处理器：CPU

### 运行 hello 程序

将 hello 目标文件中的代码和数据从磁盘中复制到 主存，处理器开始执行 hello 程序的 main 程序中的机器语言指令。将“hello，world” 字符串中的字节从主存复制到寄存器文件，再从寄存器文件中复制到显示设备。

## 高速缓存至关重要

高速缓存存储器：存储 处理器 近期可能会使用到的信息。


## 存储设备形成层次结构

![存储器层次结构](https://raw.githubusercontent.com/fangmd/markdownphoto/master/src/存储器层次结构.png)

## 操作系统管理硬件

应用程序对硬件的操作必须通过操作系统。

操作系统的两个基本功能：

1. 防止硬件被失控的应用程序滥用
2. 向应用程序提供简单一致的机制来控制复杂而又大都相同的低级硬件设备。

操作系统通过几个基本的抽象概念（进程，虚拟存储器和文件）来实现这两个功能。


### 进程

进程：创造一个假象 这个系统上只有一个程序在运行。

进程：是操作系统对一个正在运行的程序的一种抽象。

一个系统可以运行多个进程，多个进程貌似并发运行，实际上 cpu 是交错运行不同进程的指令。

上下文切换：操作系统实现交错执行的机制。

上下文：进程运行所需的所有状态信息。在切换进程的时候就需要切换上下文。

### 线程

进程可以由多个线程单元组成。

### 虚拟存储器

进程虚拟地址空间：每个进程看到一致的存储器，为每个进程提供一个假象（进程在独占使用主存）


![进程虚拟地址空间](https://raw.githubusercontent.com/fangmd/markdownphoto/master/src/进程虚拟地址空间.png)


- 程序代码和数据：大小在程序运行时就确定了
- 堆：运行时堆，在代码运行时会动态扩展和收缩
- 共享库
- 栈：编译器用它来实现函数调用。大小动态
- 内核虚拟存储器：内核总是驻留在内存中

### 文件

文件就是字节序列。

## 系统之间利用网络通信

## 重要主题

### 并发和并行

并发：同时具有多个活动的系统

并行：用并发使一个系统运行更快

1. 线程级并发：在多核CPU中可以真正支持多线程同时执行， Intel Core i7 处理器可以让一个核执行两个线程，所以4核可以并行执行8个线程。
2. 指令集并行
3. 单指令、多数据并行

### 计算机系统中抽象的重要性

# 第二章 信息的表示和处理

## 信息存储

计算机中使用 一个字节 作为做小的可寻址的存储单位。

存储器的每个字节都由一个唯一数字来标示：地址

## 十六进制表示法

一个字节8位，

二进制表示范围：00000000 - 11111111

十进制表示范围：0-255

十六进制表示范围：00-FF

### 字

### 数据大小

### 寻址和字节顺序

对于跨越多字节的程序对象，通常多字节对象被存储为连续的字节序列，对象的地址为所使用的字节中最小地址。

### 表示字符串

文字编码 Unicode 标准：UTF-8,UTF-16

要求文本串中每个字符占用4个字节，常见的字符只需要1个或者2个字节

### 布尔代数

二进制的计算方式

### c语言中的位级运算

|,&,~

### c语言中的逻辑运算

||，&&，！

### c语言中的位移运算

<<,>>

## 整数表示

### 整型数据类型

### 无符号数的编码

### 补码编码

。。。。


# 第三章 程序的机器级表示


汇编代码是机器代码的文本表示，给出程序中的每一条指令。

## 历史观点

Intel 处理器系列俗称 x86

## 程序编码

### 机器级代码

机器级程序的额格式和行为：指令集体系结（Instruction set architecture ISA）

机器级程序使用的存储器地址是虚拟地址。

。。。。


汇编




# 第四章 处理器体系结构


## Y86 指令集体系结构

## 逻辑设计和硬件控制语言 HCL


。。。。



# 第五章 优化程序性能




# 第六章 存储器层次结构


# 第七章 链接

# 第八章 异常控制流

# 第九章 虚拟存储器

# 第十章 系统级 I/O


# 第十一章 网络编程


# 第十二章 并发编程
