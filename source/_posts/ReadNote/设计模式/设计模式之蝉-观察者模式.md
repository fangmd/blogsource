---
title: 设计模式之蝉 - 观察者模式
date: 2017-07-23 21:38:14
tags: 设计模式
categories: 读书笔记

---


# 例子

## 版本一

被观察者接口：

```java
public interface IHanFeiZi{
    public void haveBreakfest();
    public void haveFun();
}
```

<!--more-->

被观察者实例：增加两个成员变量方便 Spy 监控

```java
public class HanFeiZi implements IHanFeiZi{
    private boolean isHavingBreakfast = false;
    private boolean isHavingFun = false;

    //...
}
```

观察者接口：

```java
public interface ILiSi{
    public void update(String context);
}
```

观察者实例：

```java
public class LiSi implements ILiSi{
    public void update(String str){
        // 观察到某某的变化

        // str 是观察到的结果

        // 做一些其他的操作
    }
}
```

间谍：关联观察者和被观察者

```java
class Spy extends Thread{
    private HanFeiZi hanFeiZi;
    private LiSi liSi;
    private String type

    public Spy(HanFeiZi _hanFeiZi, LiSi _liSi, String _type){
        this.hanFeiZi = _hanFeiZi;
        this.liSi = _liSi;
        this.type = _type;
    }

    @Override
    public void run(){
        while(true){
            if(this.type.equals("breakfast")){// 监控是否在吃早饭
                if(this.hanFeiZi.isHavingBreakfast()){
                    this.liSi.update("韩非子在吃早饭");
                    // 重置状态，继续监控
                    this.hanFeiZi.setHavingBreakfase(false);
                }
            }else{ // 监控是否在娱乐
                if(this.hanFieZi.isHavingFun()){
                    this.liSi.update("韩非子在娱乐");

                    this.hanFeiZi.setHavingFun(false);
                }

            }
        }
    }
}
```

以上的版本是不能用的，因为死循环导致了 cpu 飙升。

## 版本二



