---
title: 计算机网络 - 自顶向下方法
date: 2017-10-04 13:18:12
tags: [读书笔记]
category: 读书笔记

---


# 计算机网络和因特网

<!--more-->

## 什么是因特网

要说清楚什么是因特网，有两种方式：

1. 描述因特网的具体构成（基本硬件和软件组件）
2. 根据为分布式应用提供服务的联网基础设施来描述因特网

### 具体构成描述

所有连接到网络中的设备称为主机（host）或端系统（end system）

它们之间通过 *通信链路（communication link）* 和 *分组交换机（packet switch）*连接在一起。

端到端传递的信息包称为：*分组（packet）*

分组交换机最著名的两种类型：*路由器（router）* 和 *链路层交换机（link-layer switch）*

- 路由器（router）：用于网络核心中
- 链路层交换机（link-layer switch）:用于接入网中

端系统通过 因特网服务器提供商（Internet Service Provide ISP）接入因特网。

### 服务描述

分布式应用程序（distributed application）：web，qq，等网络软件

### 什么是协议

>一个协议定义了在两个或多个通信实体之间交换的报文格式和次序，以及报文发送和接收所采取的动作。

## 网络边缘 

因为所有的计算机及其他设备都处在网络的边缘所以被称为 *端系统*

端系统（主机）中可以运行应用程序。

主机也被划分为

1. client（客户）：手机，pc 等
2. server（服务器）:等同于更为强大的机器，用于存储和发布 web 页面、流视频等

### 接入网络

1. 家庭接入网络：DSL, 电缆，FTTH(到户光纤)，拨号，卫星
2. 企业（和家庭）：以太网和WIFI
3. 广域无线接入：3G，LTE

### 物理媒体

1. 双绞铜线
2. 同轴电缆
3. 光纤
4. 陆地无线电信道
5. 卫星无线电信道

## 网络核心

### 分组交换

端系统彼此交换 *报文（message）*，报文划分为较小的数据块为 *分组（packet）*

1. 存储转发传输

在交换机能够开始输出链路传输该分组的第一个比特之前，必须接受到整个分组。

延时计算：

```
d = N * L / R (L:比特长度，R：bps， N：链路条数)
```

2. 排队时延和分组丢失

每个分组交换机有多条链路与之相邻。

每条相邻的链路，该分组交换机具有一个 *输出缓存（output buffer）*

如果到达的分组需要传输到某条链路，但发现该链路正忙于传输其他分组，该到达的分组就会在输出缓存中等待（排队时延），当输出缓存满的时候就会造成丢包。

3. 转发表和路由选择协议

每个端系统具有一个称为 IP地址 的地址。源主机向目标端系统发送一个分组的时候，分组的首部包含了目的地的 IP地址。

路由器收到分组后解析出目的地的IP地址，通过其内部的 *转发表* 获取输出链路。

### 电路交换

### 网络的网络

## 分组交换网路中的时延、丢包和吞吐量

### 分组交换网中时延概述

### 排队时延和丢包

### 端到端时延

## 协议层次及服务模型

### 分层的体系结构

1. 协议分层

协议栈：各层的所有协议

协议栈由五层组成：（还有一种为 7 层模型 OSI 模型（运输层上面增加 表示层，会话层））

- 应用层：应用程序之间的协议（比如 http， SMTP, FTP）,应用层的信息分组称为 *报文（message）*
- 运输层: 在应用程序端点之间传送应用层报文。（比如 TCP, UDP），运输层的分组称为 *报文段(segment)*
- 网络层: 传输的信息称为 *数据报(datagram)*, 网络层包含了 *IP协议*。
- 链路层: 链路层分组称为 *帧 frame*，任务是将整个帧从一个网络元素移动到邻近的一个网络元素中。
- 物理层: 负责将 帧 中一个一个 比特 从一个结点移动到下一个结点，代表实际的物理传输媒介（光纤，铜线）

2. OSI 模型

OSI 是七层模型

### 封装

## 面对攻击的网络

## 计算机网络和因特网的历史

### 分组交换的发展：1961-1970

### 专用网络和网络互联：1920-1980

### 网络激增：1980-1990

### 因特网爆炸：20世纪90年代

### 最新发展

# 应用层

## 应用层协议原理

### 网络应用程序体系结构

主流的两种结构：

1. 客户-服务器体系结构
2. 对等（P2P）体系结构

### 进程通信

1. 客户和服务器进程

客户端的一个进程和服务器的一个进程进行通信。

>在给定的一对进程之间的通信会话场景中，发起通信的进程会被标示为 *客户*，在会话开始时等待联系的进程是 *服务器*。

2. 进程与计算机网络之间的接口

进程通过一个称为 *套接字（socket）*的软件接口向网络发送报文和从网络中接收报文。

3. 进程寻址

需要的信息：1. 主机的地址（IP 地址）。2. 定义目的主机中的接收进程的标示符（端口号）。

### 可供应用程序使用的运输服务

套接字（socket）是应用程序和运输层之间的接口。

一个运输层协议可以为调用它的应用程序提供的服务：可靠的数据传输，吞吐量，定时，安全性。

1. 可靠的数据传输

防止数据丢失

2. 吞吐量

吞吐量：发送进程能够向接收进程交付比特的速率。

3. 定时

避免延时过长

4. 安全性

简单的加密，数据完整性验证和断点鉴别。

### 因特网提供的运输服务

因特网提供两种运输层协议：

1. TCP

可提供下面两种服务：

- 面向连接服务：在应用层数据报文开始流动前，TCP 让客户和服务器互相交换运输层控制信息。

- 可靠数据传输服务：

>三次握手
>四次挥手+2MSL(最大报文段生存时间): FIN ACK (Servier 确认数据传输完毕可以关闭) FIN ACK
>
>无差错控制原理

2. UDP

一种不提供不必要服务的轻量级运输协议。无连接，不可靠。

### 应用层协议

应用层协议定义的内容：

1. 交换的报文类型，比如：请求报文和响应报文
2. 各种报文类型的语法，比如：各个字段以及字段如何描述
3. 字段的语义：字段中包含的意思
4. 一个进程何时以及如何发送报文，对报文响应的规则

### 本书涉及的网络应用

## Web 和 Http

### HTTP 概况

超文本传输协议 HyperText Transfer Protocol

### 非持续连接和持续连接

1. 采用非持续连接的 HTTP

往返时间（RTT），一次请求的时间时：2个RTT + 文件接收时间

2. 采用持续性连接的 HTTP

### HTTP 报文格式

1. HTTP 请求报文

例子：

```
GET /somedir/page.html HTTP:1.1
Host: www.someschool.edu
Connection: close
User-agent: Mozilla/5.0
Accept-language: fr
```

第一行：请求行（request line）,包含三个字段（方法字段，URL 字段，HTTP 版本字段）

第一行下面内容：首部行（header line）

2. HTTP 响应报文

例子：

```
HTTP:/1.1 200 OK
Connection: close
Data: Tue, 09 Aug 2011 15:44:04 GMT
Server: Apcache/2.2.3 (CentOS)
Last-Modified: Tue, 09 Aug 2011 15:44:04 GMT
Content-Length: 6812
Content-Type: text/html

(data data ...)
```


一个初始化：status line

6 个首部行

实体体: entity body

### 用户与服务器的交互：cookie

使用 cookie 对用户状态进行跟踪。弥补 HTTP 无状态缺陷。

### Web 缓存

Web 缓存器（Web cache）也叫代理服务器。

### 条件 GET 方法

Web 缓存器的存在可以提高访问的速度，但是无法保证数据是否时最新的。

HTTP 中提供了 条件GET 方法：

添加一个首部行：

```
If-Modified-Since: Web, 7 Sep 2011 09:23:24
```

如果数据没有被修改过返回的 首部行 会是：

```
HTTP/1.1 304 Not Modified
```

## 文件传输协议： FTP

基于 TCP，连接的时候需要 用户标示和口令

## 因特网中的电子邮件

## DNS：因特网的目录服务

主机标识符可以用下面两个表示：

主机名（域名）

IP地址

### DNS 提供的服务

域名系统（Domain Name System DNS）:将主机名到 IP 地址进行转换

DNS：一个由分层 DNS 服务器实现的分布式数据库；一个使得主机能够查询分布式数据库的应用层协议。

用户主机在发送 HTTP 请求的时候需要把 主机名 转换成 IP地址，可以通过下面几种方法实现转换：

1. 同一台用户主机上运行着 DNS 应用的客户端
2. 游览器从上述 URL 中抽取出主机名 ，将这个主机名传输给 DNS 应用客户端
3. DNS 客户端向 DNS 服务器发送一个包含主机名的请求
4. DNS 客户端最终会收到一份回答报文，其中包含有对应于该主机名的 IP 地址
5. 一旦游览器接收到来自 DNS 的该 IP 地址，它能够向位于该 IP 地址80端口的 HTTP 服务器进程发起一个 TCP 连接


DNS 给因特网应用带来了额外的时延，不过我们想获得的 IP 地址通常存在 “附加的” DNS 服务器中。

### DNS 工作机制概述

DNS 是一个在因特网上实现分布式数据库的精彩案例。

1. 分布式、层次数据库

有三种类型的 DNS 服务器：根服务器，顶级域DNS服务器，权威DNS服务器

查询过程中各层级服务器作用：

```
- 当查询 www.amazon.com 的时候，客户端先与根服务器联系，它将返回 顶级域名 com 的TLD服务器的IP地址
- 客户端与 这个TLD服务器联系，它将返回 amazon.com 的权威服务器IP地址
- 最后客户端与权威服务器联系
```

根 DNS 服务器：2011年有 247 个，大部分在北美洲。

顶级域 DNS 服务器：负责顶级域名

权威 DNS 服务器

本地 DNS 服务器


2. DNS 缓存

本地 DNS 服务器通常会缓存最近查询过的域名与IP地址的映射。

### DNS 记录和报文

共同实现 DNS 分布式数据库的所有 DNS 服务器存储了 *资源记录（Resource Record RR）*，RR 提供了主机名到IP地址的映射。

每个 DNS 回答报文包含了一条或多条资源记录。

一条资源记录：(Name, Value, Type, TTL)

TTL: 是该条记录的生存时间，决定资源记录应该什么时候从缓存中清除。

Name, Value 取决于 Type:

Type=A: Name 表示主机名，Value 表示主机对于的 IP地址。也就是说 一条 A 类型的资源记录提供了标准的主机名到 IP 地址的映射。

Type=NS: Name 是一个域（比如：foo.com），Value 是一个知道如何获取该域中主机 IP 地址的权威 DNS 服务器主机名。

Type=CNAME: Value 就是别名 Name 的主机对应的规范主机名。

Type=MX: Value 是一个别名 Name 邮件服务器的规范主机名。

1. DNS 报文
2. 在 DNS 数据库中插入记录

## P2P 应用

### P2P 文件分发

### 分布式散列表

## TCP 套接字编程

>书中简介了 Python 代码例子

### UDP 套接字编程

>书中简介了 Python 代码例子

### TCP 套接字编程

>书中简介了 Python 代码例子

# 运输层

## 概述和运输层服务

运输层协议为运行在不同主机上的应用进程之间提供了 *逻辑通信（logic communication）*

运输层协议是在端系统中而不是在路由器中实现的。

运输层将从发送应用程序进程中接受的到的报文转换成运输层分组：*报文段（segemnt）*

转换方法：将应用报文划分成较小的快，为每块加上一个运输层首部以生成运输层报文段。

### 运输层和网络层的关系

网络层提供了主机之间的逻辑通信。

运输层能够提供的服务会受到网络层的限制。

### 因特网运输层概述

运输层分组称为 报文段（segment）

但是： TCP 的运输层分组称为：报文段，UDP 运输层分组称为：数据报

## 多路复用与多路分解

将由网络层提供的主机到主机交付服务延伸到为运行在主机上的应用程序提供进程到进程的交付服务。

多路分解（demultiplexing）:将运输层报文段中的数据交付到正确的套接字的工作。

多路复用（multiplexing）：源主机从不同套接字中手机数据块，并为每个数据块封装上首部信息从而生成报文段，然后将报文段传递到网络层。

多路复用的要求：

1. 套接字有唯一标识符
2. 每个报文段有特殊字段来指示该报文段所要交付的套接字

特殊字段

1. 源端口号字段（source prot number field）
2. 目的端口号（destination port number field）

端口号范围：0-65535，0-1023 是 *周知端口号（well-known port number）*保留给一些特定的应用使用。

运输层实现分解服务：在主机上每个套接字能够分配一个端口号，当报文段到达主机的时候，运输层检查报文段中的目的端口号，并将其定向到相应的套接字。然后报文段中的数据通过套接字进入到其所连接的进程。

## 无连接运输：UDP

### UDP 报文段结构

- 源端口号
- 目的端口号
- 长度
- 检验和
- 应用数据（报文）

### UDP 检验和

检验应用数据是否发送了变化。

## 可靠数据传输原理

可靠数据传输协议 reliable data transfer protocal

### 构造可靠数据传输协议

>没看 

### 流水线可靠数据传输协议

>没看 

### 回退 N 步

>没看 

### 选择重传

>没看 

## 面向连接的运输：TCP

TCP 中使用了许多 可靠数据传输的原理：差错检测，重传，累计确认，定时器，用于序号和确认号的首部字段。

### TCP 连接

面向连接 connections-oriented

TCP 连接提供的是 *全双工服务（full-duplex service）*

TCP 总是 点对点 的

三次握手：

```
1. 客户端首先发送一个特殊的 TCP 报文段，
2. 服务端用另一个特殊的 TCP 报文段来响应，
3. 客户端用第三个特殊报文段作为响应。（这个报文段中承载了有效数据）
```

### TCP 报文段结构

TCP 报文段组成：

1. 首部字段：源端口号 和 目的端口号，检测和字段，用于实现可靠数据传输服务的字段（32比特 序号字段，32比特 确认号字段），用于流量控制的字段（接收窗口字段），4比特 首部长度字段，可选的 选项字段，6比特 标志字段
2. 数据字段：包含一块应用数据。


>本章 后面的都没看 

### 往返时间的估计与超时

### 可靠数据传输

### 流量控制

### TCP 连接管理

## 拥塞控制原理

### 拥塞原因与代价

### 拥塞控制方法

### 网络辅助的拥塞控制例子： ATM ABR 拥塞控制

## TCP 拥塞控制

# 网络层

运输层依赖于网络层的主机到主机的通信服务。

## 概述

### 转发和路由选择

转发：当一个分组到达路由器的一条输入链路中，路由器需要将这个分组移动到何时的输出链路。

路由选择：当分组从发送流向接收方时，网络层必须决定这些分组所采用的路由或路径。计算这些路径的算法称为 *路由选择算法*

每台路由器有一张 *转发表（forwarding table）*: 路由器通过检查到达分组的 首部字段 的值来转发分组，然后使用该值在该路由器的转发表中索引查询。

*连接建立 connection setup*: 从源到目的沿着所选择的路径彼此握手。

### 网络服务模型

网络服务模型（network service model）: 定义了分组在发送与接收端系统之间的端到端运输特性。

>本章 后面的都没看 

## 虚电路和数据报网络

### 虚电路网络

### 数据报网络

### 虚电路和数据报网络的由来

## 路由器工作原理

### 输入端口

### 交换结构

### 输出端口

### 何处出现排队

### 路由器选择控制平面

## 网际协议：因特网中的转发和编址

### 数据报格式

### IPv4 编址

### 因特网控制报文协议

### IPv6

### 涉足 IP 安全性

## 路由选择算法

### 链路状态路由选择算法

### 距离向量路由选择算法

### 层次路由选择

## 因特网中的路由选择

### 因特网中的自治系统内部的路由选择：RIP

### 因特网中的自治系统内部的路由选择：OSPF

### 自治系统间的路由选择：BGP

## 广播和多播路由选择

### 广播路由选择算法

### 多播


# 链路层：链路、接入网和局域网



# 无线网络和移动网络

# 多媒体网络

# 计算机网络中的安全

# 网络管理























