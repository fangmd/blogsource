---
title: 程序员修炼之道 从小工到专家
date: 2016-10-16 13:18:12
tags: [程序员修炼之道]
category: 读书笔记

---


# 注重实效的哲学 A Pragmatic Philosophy

注重实效的程序员的特征：处理问题的时候，把问题放在更大的语境中去思考，设法注意更大的图景。

## 我的源码让猫给吃了

为自己的行为负责。

>Proide Options, Don't Make Lame Excuses

## 软件的熵 entropy
熵 entropy :指某个系统中的“无序”的总量。当软件中的无序增长时称之为“软件腐烂” (software rot)。

破窗户理论：一扇破窗户，在一段时间内不修理，就会渐渐给建筑的居民带来一种废弃感，于是另一扇窗户破了。人们开始乱扔垃圾，出现乱涂乱画，严重的结构损坏开始了，过了一段时间，建筑被损坏的程度超出业主愿意修理的程度，而废弃就变成了现实。

>Don't Live with Broken Windows.

遇到破窗户（低劣的设计，错误的决策，或者糟糕的代码），及时修理或者加以注释 (comment out) ，或者现实“为实现”消息，或用虚设的数据 (dummy data) 代替。


<!--more-->

## 石头汤与煮青蛙

石头汤寓意：

1. 士兵戏弄了村民，利用他们的好奇心，从他们那里弄到了食物
2. 士兵充当催化剂，把村民团结起来，和他们一起做他们自己本来做不到的事

启动战役 start_up fatigue

>Be a Catalyst for Change

从村民的角度：他们不知道士兵的用意，他们在无形中去促成了整件事。

温水煮青蛙：如果把一只青蛙放在沸水中，它会一下子跳出来。但是，如果把青蛙放在冷水中，然后慢慢加热，青蛙不会注意到温度的变化，会呆在锅里直到被煮熟。

>John Lkos：士兵渐渐地欺骗村民，但是他们所催化的变化对村民完全有利，但是，渐渐地欺骗青蛙，却是在加害于它。

## 足够好的软件

现实世界中我们能做出十分完美的产品，无措的软件是不太可能的。我们所要最求的应该是制作足够好的软件。

### 让你的用户参与权衡

>Make Quality a Requirements Issue

用户往往愿意使用一些“毛边”的软件，也不愿意等待。用户在使用这些“毛边”软件的同时也是对软件趋向完美的最好动力。

### 直到何时止步


## 你的知识资产

知识和经验是我们最重要的职业财富，但遗憾的是它们是 有实效的资产 (expiring asset)

### 你的知识资产

管理知识资产于管理金融资产十分相似：

1. 严肃的投资者定期投资 作为习惯
2. 多元化是长期成功的关键
3. 聪明的投资者在保守的投资和高风险，高回报的投资之间平衡他们的资产。
4. 投资者设法低买高卖，以获取最大的回报
5. 应周期性地重新评估和平衡资产

### 经营你的资产

- 定期投资
- 多元化 掌握多种技能
- 管理风险 不要把所有的鸡蛋放在一个篮子里
- 低买高卖 优秀的新技术就像被低估的股票
- 重新评估和平衡

>Invest Regularly in Your Knowledge Portfolio

### 目标

为你的资产提供资金的最佳方式：

- 每年至少学习一种新语言 不同语言以不同的方式解决相同的问题，有助于拓宽思维
- 每季度阅读一本技术书籍
- 也要阅读非技术的书籍
- 上课
- 参加本地用户组织 不要只是听讲，而要主动参与，打听一下别人都在做什么
- 试验不同的环境
- 跟上潮流
- 上网

### 学习的机会

### 批判的思考

对于搜索的到的东西要有自己的判断。

>Critically Analyze What You Read and Hear

## 交流

没有有效的交流，一个好想法就只是一个无人关心的孤儿。

### 直到你想要说什么

将要说的东西列成大纲，然后确定是否就是要说的全部内容了。

### 了解你的听众

对于不同的听众，我们需要不同的表述方式。

### 选择时机

确定对方有时间去和你交谈，不然仓促的交谈不会顺利也不会有好的结果。

    现在我们可以谈谈。。。吗？

### 选择风格

调整交流的风格，让其适应听众。

有的人喜欢正式的简报，有的人喜欢表述。

### 让文档美观

### 让听众参与

我们通常会感觉到我们制作完成的文档并不是那么重要。

如果可能让你的读者参与文档的早起制作，获取他们的反馈，及早了解文档的轻重与问题。

### 做倾听者

鼓励大家通过提问交流，或者让他们总结你告诉他们的东西，把会议变成对话。

### 回复他人

>It's Both What You Say and the Way You Say it 你说什么和你怎样说同样重要

# 注重实效的途径 A Pragmatic Approach


## 重复的危害

DRY的原则：系统中的每一项知识都必须具有单一，无歧义，权威的表示

>DRY - Don't Repeat Yourself

### 重复是怎样发生的

- 强加的重复 imposed duplication 开发者觉得无可选择，环境要求重复
- 无意的重复 inadvertent duplication 开发者没有意思到他们在重复信息
- 无耐性的重复 impatient duplication 开发者偷懒的重复
- 开发者之间的重复 interdeveloper duplication

#### 强加重复

#### 无意的重复

java中使用getter／setter函数来读取函数对象的属性，使未来增加功能更加容易。

#### 无耐性的重复

由于时间的压力，拷贝原来的代码稍加修改使用。

#### 开发者之间的重复

>Make It Easy to Reuse

要营造的环境：在项目中找到可服用的代码，比自己编写代码更容易

## 正交性

如果要制造易于设计，构建，测试及扩展的系统，正交性是一个十分关键的概念。

### 什么是正交性

两条垂直的直线，就是正交。

两条直线互不依赖，两条直线在延长的过程中其投影到另一条直线上的位置不变。

不互相依赖，解耦

### 非正交系统

比如直升机的操作：每个控制输入都有次级效应。压低左手的操作杆，需要补偿性地后移右手柄，并踩右踏板。。。。

### 正交的好处

>Eliminate Effects Between Unrelated Things

#### 提高生产率

#### 降低风险

- 有问题的代码区域被隔离，比如某个模块出问题，不会把病症扩散到系统的其余部分，而且跟换模块也方便
- 所得系统更健壮 对于特定区域的小改动，即使出问题也不会影响很大
- 正交系统有很好的测试


### 项目团队

如果项目中的成员之间的任务向交点太多，就会增加沟通成本。

### 设计

对于正交设计的测试方法：如果一个特定代码改变，有多少模块会受影响

### 工具箱与库

### 编码

- 让你的代码保持解耦
- 避免使用全局数据
- 避免编写相似的函数

### 测试

正交地设计和实现的系统易于测试，因为系统的各个组件间的交互是形式化的和有限的。

同时单元测试比集成测试要方便的多。

### 文档

正交性也适用于文档

### 认同正交性


## 可撤销性

### 可撤销性

需要保证所做的决策是可撤销的

>There Are No Final Decisions 不存在最终决策

### 灵活的架构

## 曳光弹

在黑暗中射击如何判断是否命中敌人：

1. 通常做法是精确计算：找出目标位置，确定环境，确定子弹，手枪的规格。
2. 使用曳光弹，它能给出及时的反馈是否命中目标。

在项目中编写代码也相同，我们如何能够快速直到编写的代码起到了应有的作用？

### 在黑暗中发光的代码

曳光弹行之有效，是因为它们与真正的子弹在相同的环境中，相同的约束下工作，快速飞向目标，枪手可以即时取得反馈。

>Use Tracer Bullets to Find Target 使用曳光弹找到目标

曳光弹代码优点：

1. 用户能够及早看见能工作的东西
2. 开发者构建了一个他们能在其中工作的结构
3. 你有了一个集成平台
4. 你有了可用于演示的东西
5. 你将能够感觉到工作的进展

### 曳光弹并非总能击中目标

### 曳光代码 vs 原型制作

区别：原型制作属于用过就扔的代码，曳光代码虽然简约但是完整，并最终成为系统骨架的一部分。

## 原型与便签

### 制作架构原型

## 领域语言

## 估算

通过估算，加深对程序的理解。

### 多准确才足够准确

比如：如果你说做某件事需要130个工作日，那么大家会期望你在相当接近的时间内完成。但是如果说大概6个月，那么大家就期望你在5-7个月内完成。

两者的精度相差很大。

#### 估算来自哪里

所有的估算都基于问题的模型

#### 理解提问的内容

估算练习的第一步：建立对提问内容的理解

#### 建立系统的模型

#### 把模型分解为组件

#### 给每个参数指定值

#### 计算答案

#### 追踪你的估算能力

将每次估算的结果进行终结，提高自己的估算能力

#### 估算项目进度

### 在被要求进行估算时所说什么

放慢估算的速度

# 基本工具 The Basic Tools

## 纯文本的威力

作为注重实效的程序员，我们的基本材料是知识。

持久存储知识的最佳格式是纯文本

### 什么是纯文本

由可打印字符组成，人可以直接阅读和理解的形式

纯文本并不意味着无结构，XML，JSON，HTML都是良好定义的结构的纯文本的好例子。

>Keep Knowledge in Plain Text

### 缺点

1. 与压缩的二进制相比，存储的空间更多
2. 要解释及处理纯文本文件，在计算上的代价更大

### 文本的威力

1. 保证不过时
2. 杠杆作用
3. 易于测试

## shell 游戏

对于操纵文本文件的程序员，工作台就是命令shell

## 强力编辑

## 源码控制

## 调试

。。。。。

# 注重实效的偏执 Pragmatic Paranoia

>You Can't Write Perfect Software

DBC原则

>Design with Contracts


## 死程序不说谎

## 要奔溃，不要破坏

比如：中断程序而不是将错误的数据保存到数据库中。

## 断言式编程

>If it Can't Happen, User Assertions to Ensure That It Won't

### 让断言开着

关于断言的误解说法：

    断言给代码增加了一些开销，因为它们检查的是绝不应该发生的事情，所以只会由代码中的bug触发，一旦代码经过了测试并发布出去，它们就不再需要存在，应该被关闭，以使代码运行得更快，断言是一种调试设施。

错误：测试不能测试出所有的bug，仍然有许多突发情况，还是需要断言检查疏漏

### 何时使用异常

检查每一个可能的错误，特别是意料之外的错误是一种良好的实践。但是这样的做法可能会把程序引向丑陋的代码（有很多if...else 处理错误）

可是使用 try...catch 代替

#### 什么是异常情况

## 怎样配平资源

### 嵌套的分配

。。。。


# 弯曲，或折断

怎样做出可撤销的决策，使代码面对不确定的世界时保持灵活性和可适应性。

创建灵活代码的关键概念是数据模型（model）与该模型的视图（View）的分离，解除视图和模型的耦合。

接触耦合做法：提供一个 聚会地点

## 解耦与得墨忒耳法则

编写“羞涩”的代码是有益的，“羞涩”的代码工作方式：

1. 不向别人暴露自己
2. 不与太多的人打交道

### 是耦合减至最少

比如盖房子，客户把建房的任务交给了一个总承包人，总承包人会去找子承包人完成整个项目，但是这个过程中客户是不需要知道子承包的人。

软件中也同样，需要一个对象完成某个任务，但是不必知道这个对象完成这个任务需要调用的第三方对象。


例子：

    在函数调用的参数中设置直接需要的对象，而不是获取能够获取到需要的对象的间接对象。

    有助于减少这个方法的依赖


### 函数的得墨忒耳法则

防止为了获取第三个对象的方法的访问而进入某个对象。

### 这真的有关系吗

遵循得墨忒耳法则真的有助于创建维护性更好的代码？

函数的得墨忒耳法则：

    某个对象的任何方法多应该只调用属于一下情形的方法：

    1. 它自身
    2. 传入该方法的参数
    3. 它创建的对象
    4. 任何直接持有的组件对象

## 元程序设计

细节会弄乱我们整洁的代码。

### 动态配置

>Configure, Don't Integrate

用元数据（metadata）描述应用的配置选项：调谐参数，用户偏好（user pregerence），安装目录，等等

元数据：关于数据的数据。 比如：数据库 schema 或数据词典

### 元数据驱动的应用

>Put Abstractions in Code, Details in Metadata

不只是要把元数据用作简单的偏好，更要通过元数据配置和驱动应用。

目标是以声明方式思考（规定要做什么，而不是怎样做），并创建高度灵活和可适应的程序。

好处：

- 迫使你接触你的设计的耦合，带来更灵活，可适应性更好的程序
- 迫使你通过推迟细节处理，创建更健壮，更抽象的设计
- 无需重新编译应用，就可以对其进行定制，还可以通过这个层面的定制，绕开正在运行的产品系统中的重大bug
- 于通用的编程语言的情况相比，可以通过一种大为接近问题领域的方式表示元数据
- 用相同的应用引擎，但是用不同的元数据，实现若干个不同的项目


推迟大多数细节的定义，直到最后，并且尽可能让细节保持“软和”。

### 商业逻辑

让数据库引擎变成了配置选项，并提供了元数据来确定用户界面风格。



## 时间耦合 temporal coupling

时间的两个方面很重要：并发，次序

线性处理的事情会带来时间耦合

### 工作流

通常需要把用户的工作流当作需求分析的一部分来进行建模和分析，找出同一时间可能发生什么，以及哪些事件需要严格的次序。***UML活动图（UML activity diagram）***

### 架构

### 为并发进行设计


### 更整洁的接口

>Always Design for Concurrency

### 部署




## 它只是视图

不要把程序写成一大块，而应该“分而治之”，把程序划分成模块。

模块（或类）的一个好定义：具有单一，定义良好的责任。

但是各个模块如何交流，如何管理它们之间的逻辑依赖？

事件 event：特殊的消息，通过事件通知可能感兴趣的对象。事件发送者不需要对接收者有任何明确的了解。

### 发布／订阅

通过单个例程推送所有事件的缺点：破坏了对象的封装，一个例程必须对多个对象间的交互有密切的了解，增加了耦合。

所以***订阅***，对象进行登记，只接收它们需要的事件。

***序列图***：说明若干对象间的消息流，对象按列排列，每个消息用有标记的箭头表示，从发送者所在的列指向接收者所在的列。

### Model-View-Controler

### java树视图

## 黑板

>一块黑板，每个警探将自己发现的线索写在上面，警探之间不需要知道对方是谁，每个人将资源共享在黑板上。


黑板系统完全解除对象之间的耦合。

### 黑板实现

黑板系统最初是为人工智能中应用而发明的，需要解决的问题大而复杂：语音识别，基于知识的推理系统。

### 应用实例

>Use Blackboards to Coordinate Workflow

我们可以用黑板协调完全不同的事实和因素，同时又使各参与方保持独立，甚至隔离

# 当你编码时 While You Are Coding   

## 靠巧合编程

避免靠巧合编程，依靠运气和偶然的成功，而要深思熟虑地编程。

### 怎样靠巧合编程

在写完一段代码后发现可以工作，虽然不知道为什么，但是在以后的运行中出现了问题，由于当时编写的时候不知道代码为什么工作，现在更是不知道为什么不工作，这代码的维护难度就加大了。

### 实现的偶然

### 语境的偶然

### 隐含的假定

### 怎样深思熟虑地编程

1. 总是意思到你在做什么
2. 不要盲目编程
3. 按照计划行事，不管计划是在你的头脑中
4. 依靠可靠的事物，而不依靠巧合或假顶
5. 为你的假定建立文档
6. 不要只是测试你的代码，还要测试你的假定
7. 为你的工作划分优先级
8. 不要做历史的奴隶


## 算法速率

估算算法使用的资源

### 估算算法是什么意思

大多数算法都不是线性的，在算法执行的时候其花费的资源可能会很大。

### O()表示法

>处理近似计算的一种数学途径

...


## 重构

随着程序的演化，有必要重新思考早先的决策，并重写这部分代码。

重构 refactoring 重写，重做和重新架构代码合起来。

### 你应在何时进行重构

1. 重复，违反 DRY 原则
2. 非正交的设计
3. 过时的知识
4. 性能

### 现实世界的复杂情况

现实中有很多因素制约了我们重构的想法，比如项目时间问题。

### 怎样进行重构

怎样进行利大于弊的重构：

1. 不要试图在重构的同时增加功能
2. 在开始重构之前，确保拥有良好的测试
3. 采取短小，深思熟虑的步骤

## 易于测试的代码

软件IC：比喻可复用性和基于组件的开发，意思是软件组件应该像集成电路芯片一样进行组合，当然同时这些组件在使用前就需要知道其是可行的。

### 单元测试

硬件的芯片测试大致等价于软件中的单元测试：在隔离状态下对模块进行测试

软件的单元测试是对模块进行演练的代码

### 针对合约进行测试

>Design to Test

### 编写单元测试

### 使用测试装备

### 构建测试窗口

### 测试文化

## 邪恶的向导

# 在项目开始之前

## 需求之坑

>Don't Gather Requirements - Big for Them 不要搜集需求-挖掘它们

### 挖掘需求

好的需求应该表示十分明确。

比如：

    1. 只有人事部门的人才能查看员工档案
    2. 只有得到授权的用户才可以访问员工档案

以第二种方式收集需求有助于开发有良好分解的系统

需求，政策，实现

用文档记载需求背后的原因将在每天进行实现决策时给团队带来无价的信息。

### 建立需求文档

### 固定过度

好的需求文档会保持抽象

### 看远些

>Abstractiond Live Longer than Details 抽象比细节活的更长久

抽象不是要预测未来，而是将需求写的跟为变通。

### 再抹一层薄薄的薄荷

许多项目的失败都被归咎于项目范围的增大，特性膨胀

### 维护词汇表

>Use a Project Glossary 使用项目词汇表

用户和开发者用相同的名称指称同一事物。

### 把话说出来

## 解开不可能解开的谜题

从不同的角度考虑问题

### 自由度

面对棘手的问题，列出所有在你面前的可能途径。不要排除任何东西，不管它听起来有多无用或愚蠢。

### 一定有更容易的方法

对需求重新诠释，发掘需求的真正约束。

### 挑战

>Listen to Nagging Doubts - Start When You're Ready 倾听反复出现的疑虑，等你准备好再开始

### 是良好的判断，还是拖延

## 规范陷阱

编写程序规范就是把需求归纳到程序员能够接管的程度的过程。

## 圆圈与箭头

# 注重实效的项目 Pragmatic Projects

## 注重实效的团队

### 不要留破窗户

鼓励修改小问题

### 煮青蛙

一个人的热情容易被一个消极的团队消磨。

### 交流

团队建设

### 不要重复自己

可以有一个人或者多人负责建立项目文档和工作文档。

### 正交性
